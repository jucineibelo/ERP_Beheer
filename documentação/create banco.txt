CREATE TABLE FILIAL(
ID INT PRIMARY KEY NOT NULL IDENTITY(1,1), 
RAZAO VARCHAR(100) , 
FANTASIA VARCHAR(100),
CNPJ VARCHAR(30),
TELEFONE VARCHAR (30)
);

INSERT INTO FILIAL 
(RAZAO, FANTASIA, CNPJ, TELEFONE)
VALUES
('EMPRESA 2 TESTE LTDA', 'EMPRTEST 2', '62.322.522/0001-67 ', '49 998192395');


CREATE TABLE PESSOA(
ID INT PRIMARY KEY NOT NULL IDENTITY(1,1), 
RAZAO VARCHAR(100) , 
FANTASIA VARCHAR(100),
TELEFONE VARCHAR (30),
CNPJ_CPF VARCHAR(30),
IE_RG VARCHAR(30),
OBSERVACAO VARCHAR(200),
TIPO_PESSOA INT
);

INSERT INTO PESSOA 
(RAZAO,FANTASIA, TELEFONE, CNPJ_CPF, IE_RG, OBSERVACAO, TIPO_PESSOA)
VALUES 
( 'JUCINEI LUIZ BELO','JUCINEI', '49998192395', '058.625.639-89','5.365.258', 'OBSERVAÇÃO', 1);


INSERT INTO PESSOA 
(RAZAO,FANTASIA, TELEFONE, CNPJ_CPF, IE_RG, OBSERVACAO, TIPO_PESSOA)
VALUES 
( 'CLIENTE PIX','', 'PIX', '000.000.000-00',NULL, 'CLIENTE VENDA PIX', 1);

UPDATE PESSOA
SET CNPJ_CPF = '000.000.000-00'
WHERE CNPJ_CPF = '000.000.000-89' 



CREATE TABLE ENDERECO(
ID INT PRIMARY KEY NOT NULL IDENTITY(1,1), 
PESSOA INT, 
CEP VARCHAR(20),
CIDADE VARCHAR(50),
ENDERECO VARCHAR (100),
BAIRRO VARCHAR(50),
OBSERVACAO VARCHAR(100)
);

ALTER TABLE ENDERECO
ADD CONSTRAINT FK_PESSOA 
FOREIGN KEY (PESSOA)
REFERENCES PESSOA (ID);

ALTER TABLE ENDERECO 
ADD NUMERO VARCHAR (20);

INSERT INTO ENDERECO 
(PESSOA, CEP, CIDADE, ENDERECO, BAIRRO, OBSERVACAO)
VALUES 
(1, '89820000', 'XANXERE', NULL, NULL, 'OBSERVACAO');

SELECT P.RAZAO FROM ENDERECO E
INNER JOIN PESSOA P ON P.ID = E.PESSOA; 


CREATE TABLE PRODUTOS(
ID INTEGER PRIMARY KEY NOT NULL,
NOME_PRODUTO VARCHAR(100),
NOME_POPULAR VARCHAR(100),
CODIGO_BARRA VARCHAR(50),
REFERENCIA VARCHAR(50),
GRUPO integer,
SUBGRUPO INTEGER);


CREATE TABLE PRODUTOS_DETALHES(
ID INTEGER PRIMARY KEY NOT NULL,
ID_PRODUTO integer, 
ID_FILIAL INTEGER,
CUSTO_INICIAL NUMERIC(15,2),
VENDA_AVISTA NUMERIC(15,2),
VENDA_APRAZO NUMERIC(15,2),
SITUACAO_TRIBUTARIA INTEGER,
NCM INTEGER);

ALTER TABLE PRODUTOS_DETALHES
ADD CONSTRAINT FK_PRODUTOS_DETALHES_2
FOREIGN KEY (ID_FILIAL)
REFERENCES FILIAL(ID)


CREATE TABLE SITUACAO_TRIBUTARIA (
ID INTEGER PRIMARY KEY NOT NULL,
DESCRICAO VARCHAR(100),
CST VARCHAR(10)
);

ALTER TABLE PRODUTOS_DETALHES
ADD CONSTRAINT FK_PRODUTOS_DETALHES_3
FOREIGN KEY (SITUACAO_TRIBUTARIA)
REFERENCES SITUACAO_TRIBUTARIA(ID)


ALTER TABLE PRODUTOS_DETALHES DROP NCM

ALTER TABLE PRODUTOS 
ADD NCM VARCHAR(10)

ALTER TABLE PRODUTOS_DETALHES
ADD ESTOQUE NUMERIC(15,2)


create table ESTOQUE (
ID int primary key not null,
TIPO int,
DATA_ DATE,
HORA time,
DESCONTO NUMERIC(15,2),
VLR_TOTAL NUMERIC(15,2)
);


create table ESTOQUE_ITEM(
ID INT PRIMARY KEY NOT NULL,
ID_ESTOQUE integer, 
ID_PRODUTO integer,
QTDE NUMERIC(15,2),
VALOR_UNITARIO NUMERIC(15,2),
DESCONTO(15,2),
VALOR_TOTAL NUMERIC(15,2)
);

alter TABLE estoque_item
add constraint FK_ESTOQUE
foreign key (ID_ESTOQUE)
REFERENCES ESTOQUE(ID)

alter TABLE estoque_item
add constraint FK_PRODUTO
foreign key (ID_PRODUTO)
REFERENCES PRODUTOS(ID)




